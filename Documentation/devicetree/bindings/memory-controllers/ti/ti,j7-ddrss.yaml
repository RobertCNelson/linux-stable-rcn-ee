# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/memory-controllers/ti/ti,j7-ddrss.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: TI wrapper module for the Cadence DDRSS controller

maintainers:
  - Gandhar Deshpande <g-deshpande@ti.com>
  - Santhosh Kumar K <s-k6@ti.com>
  - Neha Malcom Francis <n-francis@ti.com>

description: |
  The J721E DDR subsystem comprises DDR controller, DDR PHY and wrapper
  logic to integrate these blocks in the device. The DDR subsystem is
  used to provide an interface to external SDRAM devices which can be
  utilized for storing program or data.

properties:
  compatible:
    enum:
      - ti,j7-ddrss
      - ti,am62-ddrss
      - ti,am62a-ddrss

  reg:
    minItems: 1
    maxItems: 2
    description: |
      Address ranges for the different register regions of the DDRSS controller.
      - ss_cfg: Subsystem configuration registers

  reg-names:
    items:
      - const: ss_cfg

  ranges:
    minItems: 1

  interrupts:
    maxItems: 1
    description: |
      Interrupt line for the DDR subsystem controller. This interrupt is
      typically used for temperature monitoring and error reporting.

  power-domains:
    minItems: 1
    maxItems: 2
    description: |
      Power domains required by the DDR subsystem:
      - an entry to TISCI DDR CFG device
      - an entry to TISCI DDR DATA.

  clocks:
    minItems: 1
    maxItems: 2
    description: |
      - An entry to DDRSS clock
      - An entry to SoC bypass clock

  ti,ddr-freq1:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: |
      Primary DDR frequency setting in Hz. This value is used for
      normal operation of the DDR subsystem.

  ti,ddr-freq2:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: |
      Secondary DDR frequency setting in Hz. This value can be used
      for power saving or performance modes.

  ti,ddr-fhs-cnt:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: |
      Frequency handover sequence count. This value defines how many
      steps to use when switching between frequency settings.

  '#address-cells':
    const: 2

  '#size-cells':
    const: 2

patternProperties:
  "^ddr@":
    type: object

required:
  - compatible
  - reg
  - reg-names
  - ranges
  - interrupts
  - power-domains
  - clocks

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/arm-gic.h>
    #include <dt-bindings/soc/ti,sci_pm_domain.h>

    cbass_main {
      #address-cells = <2>;
      #size-cells = <2>;

      memorycontroller: memory-controller@298e000 {
        compatible = "ti,j7-ddrss";
        reg = <0x00 0x02980000 0x00 0x184>;
        reg-names = "ss_cfg";
        ranges = <0x00 0x00 0x00 0x02990000 0x00 0x00004000>;
        interrupts = <GIC_SPI 216 IRQ_TYPE_LEVEL_HIGH>;
        power-domains = <&k3_pds 8 TI_SCI_PD_EXCLUSIVE>,
                      <&k3_pds 90 TI_SCI_PD_SHARED>;
        clocks = <&k3_clks 8 0>, <&k3_clks 30 9>;
        bootph-pre-ram;
        ti,ddr-freq1 = <0x27b9fba0>;
        ti,ddr-freq2 = <0x27b9fba0>;
        ti,ddr-fhs-cnt = <0xa>;
        #address-cells = <2>;
        #size-cells = <2>;

        ddr@0 {
          compatible = "cdns,j7-ddr";
          reg = <0x00 0x0000 0x00 0x72c>,
                <0x00 0x2000 0x00 0x4b0>,
                <0x00 0x4000 0x00 0x163c>;
          reg-names = "ctl_cfg", "ctl_cfg_pi", "ctl_cfg_phy";
          bootph-pre-ram;

          ti,ctl-data = <
            0xb00
            0x0
            0x0
          >;

          ti,pi-data = <
            0xb00
            0x0
            0x0
          >;

          ti,phy-data = <
            0x4f0
            0x0
            0x30200
          >;
        };
      };
    };
